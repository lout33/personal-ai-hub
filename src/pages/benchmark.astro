---
import Layout from '../layouts/Layout.astro';
---

<Layout 
  title="Find Your AI Match - Which AI Thinks Like You?" 
  description="Claude, GPT, or Gemini? Take this 2-minute quiz to discover which AI model fits your thinking style. Based on real personality research."
  canonicalURL="https://symbiotic.makestudio.app/benchmark"
>
  <div class="min-h-screen flex flex-col bg-zinc-50 dark:bg-zinc-950">
    <header class="fixed top-0 left-0 right-0 z-40 bg-zinc-50/80 dark:bg-zinc-950/80 backdrop-blur-md border-b border-zinc-200 dark:border-zinc-800">
      <div class="max-w-2xl mx-auto px-6 py-4 flex items-center justify-between">
        <a href="/" class="text-lg font-semibold">Symbiotic</a>
        <div id="progress-container" class="hidden flex-1 max-w-xs mx-8">
          <div class="flex items-center gap-3">
            <div class="flex-1 h-1 bg-zinc-200 dark:bg-zinc-800 rounded-full overflow-hidden">
              <div id="progress-bar" class="h-full bg-zinc-900 dark:bg-white transition-all duration-500" style="width: 0%"></div>
            </div>
            <span id="step-counter" class="text-sm text-zinc-500 tabular-nums">1/7</span>
          </div>
        </div>
      </div>
    </header>

    <main class="flex-1 flex items-center justify-center px-6 pt-24 pb-10">
      <div class="w-full max-w-xl">
        
        <!-- Welcome Screen -->
        <div id="welcome-screen" class="text-center space-y-8">
          <div class="space-y-4">
            <h1 class="text-3xl md:text-4xl font-bold">Which AI Thinks Like You?</h1>
            <p class="text-lg text-zinc-600 dark:text-zinc-400 max-w-md mx-auto">
              Claude, GPT, and Gemini have different personalities. Find which one matches how you actually think.
            </p>
          </div>
          
          <div class="bg-zinc-100 dark:bg-zinc-900 rounded-2xl p-6 text-left space-y-4 max-w-md mx-auto">
            <div class="flex items-start gap-3">
              <div class="w-8 h-8 rounded-full bg-zinc-200 dark:bg-zinc-800 flex items-center justify-center flex-shrink-0 mt-0.5">
                <span class="text-sm">ðŸ”¬</span>
              </div>
              <div>
                <p class="font-medium">Based on real research</p>
                <p class="text-sm text-zinc-500">Questions mapped to measured AI personality differences.</p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <div class="w-8 h-8 rounded-full bg-zinc-200 dark:bg-zinc-800 flex items-center justify-center flex-shrink-0 mt-0.5">
                <span class="text-sm">âš¡</span>
              </div>
              <div>
                <p class="font-medium">7 questions, 2 minutes</p>
                <p class="text-sm text-zinc-500">Pick what feels right, not what sounds good.</p>
              </div>
            </div>
          </div>
          
          <button id="start-btn" class="px-8 py-3 bg-zinc-900 dark:bg-white hover:bg-zinc-700 dark:hover:bg-zinc-200 text-white dark:text-zinc-900 font-medium rounded-xl transition-colors">
            Find My Match
          </button>
        </div>

        <!-- Question Screen -->
        <div id="question-screen" class="hidden space-y-6">
          <div id="scenario-label" class="text-xs font-medium text-zinc-500 uppercase tracking-wider"></div>
          <h2 id="question-text" class="text-xl md:text-2xl font-semibold leading-relaxed"></h2>
          <p id="question-subtext" class="text-zinc-500 text-sm hidden"></p>
          
          <div id="options-container" class="space-y-3"></div>
        </div>

        <!-- Analyzing Screen -->
        <div id="analyzing-screen" class="hidden text-center space-y-6">
          <div class="space-y-4">
            <div class="w-16 h-16 mx-auto rounded-full bg-zinc-100 dark:bg-zinc-900 flex items-center justify-center">
              <svg class="w-8 h-8 text-zinc-400 animate-spin" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
            </div>
            <h2 class="text-xl font-semibold">Analyzing your responses...</h2>
            <p id="analyzing-text" class="text-zinc-500">Matching your thinking style</p>
          </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="hidden space-y-8">
          
          <!-- Result Card (Screenshot-friendly) -->
          <div id="result-card" class="bg-gradient-to-br from-zinc-900 to-zinc-800 text-white rounded-2xl p-8 space-y-6 shadow-2xl">
            <div class="text-center space-y-2">
              <p class="text-zinc-400 text-xs uppercase tracking-widest">Your AI Match</p>
              <div class="flex items-center justify-center gap-3">
                <span id="result-icon" class="text-5xl"></span>
                <div class="text-left">
                  <h2 id="result-name" class="text-3xl font-bold"></h2>
                  <p id="result-archetype" class="text-zinc-400 text-sm"></p>
                </div>
              </div>
            </div>
            
            <!-- Match bar -->
            <div class="flex items-center justify-center gap-3">
              <div class="h-2 flex-1 bg-zinc-700 rounded-full overflow-hidden max-w-xs">
                <div id="match-bar" class="h-full rounded-full transition-all duration-1000 ease-out" style="width: 0%"></div>
              </div>
              <span id="match-percentage" class="text-sm font-bold tabular-nums"></span>
            </div>
            
            <!-- Quotable line -->
            <div class="text-center py-2">
              <p id="result-quotable" class="text-lg italic text-zinc-300"></p>
            </div>
            
            <!-- Traits -->
            <div id="traits-container" class="flex flex-wrap justify-center gap-2"></div>
            
            <p class="text-center text-zinc-600 text-xs pt-2">symbiotic.makestudio.app/benchmark</p>
          </div>
          
          <!-- Detailed Results -->
          <div class="space-y-4">
            <div class="bg-zinc-100 dark:bg-zinc-900 rounded-2xl p-6 space-y-3">
              <h3 class="font-semibold">Why <span id="why-model-name"></span>?</h3>
              <p id="result-description" class="text-zinc-600 dark:text-zinc-400 leading-relaxed"></p>
            </div>
            
            <div class="bg-zinc-100 dark:bg-zinc-900 rounded-2xl p-6 space-y-3">
              <h3 class="font-semibold">Best for</h3>
              <p id="best-for-text" class="text-zinc-600 dark:text-zinc-400"></p>
            </div>
            
            <div class="bg-zinc-100 dark:bg-zinc-900 rounded-2xl p-6 space-y-3">
              <h3 class="font-semibold">Watch out for</h3>
              <p id="watch-out-text" class="text-zinc-600 dark:text-zinc-400"></p>
            </div>
            
            <div class="bg-zinc-100 dark:bg-zinc-900 rounded-2xl p-6 space-y-3">
              <div class="flex items-center justify-between">
                <h3 class="font-semibold">Runner up</h3>
                <span id="runner-up-percentage" class="text-sm text-zinc-500"></span>
              </div>
              <div class="flex items-center gap-2">
                <span id="runner-up-icon" class="text-xl"></span>
                <span id="runner-up-name" class="font-medium"></span>
              </div>
              <p id="runner-up-description" class="text-zinc-600 dark:text-zinc-400 text-sm"></p>
            </div>
          </div>
          
          <!-- Actions -->
          <div class="flex flex-col items-center gap-4">
            <button id="share-btn" class="px-8 py-3 bg-zinc-900 dark:bg-white hover:bg-zinc-700 dark:hover:bg-zinc-200 text-white dark:text-zinc-900 font-medium rounded-xl transition-colors flex items-center gap-2">
              <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
              Share Result
            </button>
            <button id="retake-btn" class="text-sm text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300">
              Retake Quiz
            </button>
          </div>
          
          <!-- CTA -->
          <div class="bg-gradient-to-br from-zinc-100 to-zinc-50 dark:from-zinc-900 dark:to-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-2xl p-6 space-y-3">
            <h3 class="font-semibold">Make any AI understand you</h3>
            <p class="text-sm text-zinc-600 dark:text-zinc-400">
              Symbiotic AI gives any model your context, psychology, and working style. Your AI match is just the start.
            </p>
            <div class="flex gap-3 pt-2">
              <a href="/discover" class="px-5 py-2 bg-zinc-900 dark:bg-white hover:bg-zinc-700 dark:hover:bg-zinc-200 text-white dark:text-zinc-900 text-sm font-medium rounded-xl transition-colors">
                Create Profile
              </a>
              <a href="/" class="px-5 py-2 border border-zinc-300 dark:border-zinc-600 hover:bg-zinc-100 dark:hover:bg-zinc-800 text-sm font-medium rounded-xl transition-colors">
                Learn More
              </a>
            </div>
          </div>
        </div>
        
      </div>
    </main>
  </div>
</Layout>

<script>
  // V2 Questions - Scenario-based, mapped to real AI differences
  const questions = [
    {
      id: "idea_response",
      scenario: "The Idea Test",
      question: "You share a business idea with your AI. What response do you want?",
      options: [
        { 
          id: "challenge", 
          label: "\"I see three problems with this. Let me explain...\"",
          scores: { claude: 3, gpt: 0, gemini: 1 } 
        },
        { 
          id: "enthusiastic", 
          label: "\"Great idea! Here's how to make it even better...\"",
          scores: { claude: 0, gpt: 3, gemini: 1 } 
        },
        { 
          id: "practical", 
          label: "\"Here's a quick implementation plan. What's first?\"",
          scores: { claude: 1, gpt: 1, gemini: 3 } 
        }
      ]
    },
    {
      id: "feedback_style",
      scenario: "The Review",
      question: "You ask the AI to review your work. Ideally it would...",
      options: [
        { 
          id: "honest", 
          label: "Point out what's not working, even if it stings",
          scores: { claude: 3, gpt: 0, gemini: 1 } 
        },
        { 
          id: "balanced", 
          label: "Highlight strengths first, then suggest improvements",
          scores: { claude: 1, gpt: 3, gemini: 1 } 
        },
        { 
          id: "actionable", 
          label: "Skip the commentary, just give me fixes",
          scores: { claude: 0, gpt: 1, gemini: 3 } 
        }
      ]
    },
    {
      id: "validation_check",
      scenario: "The Validation Test",
      question: "Your AI says your work is \"impressive\" and \"visionary.\" You think...",
      options: [
        { 
          id: "suspicious", 
          label: "Is it actually good, or is it just being nice?",
          scores: { claude: 3, gpt: 0, gemini: 2 } 
        },
        { 
          id: "appreciate", 
          label: "Nice! That validation helps me keep going",
          scores: { claude: 0, gpt: 3, gemini: 1 } 
        },
        { 
          id: "irrelevant", 
          label: "I don't care about praise. Does it work or not?",
          scores: { claude: 1, gpt: 0, gemini: 3 } 
        }
      ]
    },
    {
      id: "uncertainty",
      scenario: "The Unknown",
      question: "You ask a question the AI isn't sure about. You prefer it to...",
      options: [
        { 
          id: "admit", 
          label: "Say \"I'm not certain\" and explain what it doesn't know",
          scores: { claude: 3, gpt: 1, gemini: 1 } 
        },
        { 
          id: "best_guess", 
          label: "Give its best answer with appropriate caveats",
          scores: { claude: 1, gpt: 3, gemini: 1 } 
        },
        { 
          id: "options", 
          label: "Present multiple possibilities and let me choose",
          scores: { claude: 1, gpt: 1, gemini: 3 } 
        }
      ]
    },
    {
      id: "work_style",
      scenario: "The Task",
      question: "How do you typically work with AI?",
      options: [
        { 
          id: "conversation", 
          label: "Long conversations, thinking things through together",
          scores: { claude: 3, gpt: 2, gemini: 0 } 
        },
        { 
          id: "varied", 
          label: "Mix of quick questions and deeper exploration",
          scores: { claude: 1, gpt: 3, gemini: 1 } 
        },
        { 
          id: "dump", 
          label: "Dump context, get output, iterate fast",
          scores: { claude: 0, gpt: 1, gemini: 3 } 
        }
      ]
    },
    {
      id: "personality_pref",
      scenario: "The Vibe",
      question: "What AI personality appeals to you?",
      options: [
        { 
          id: "thoughtful", 
          label: "Thoughtful and careful. Will challenge my assumptions.",
          scores: { claude: 3, gpt: 1, gemini: 0 } 
        },
        { 
          id: "helpful", 
          label: "Warm and helpful. Always ready to assist.",
          scores: { claude: 1, gpt: 3, gemini: 0 } 
        },
        { 
          id: "efficient", 
          label: "Efficient and fast. Personality is irrelevant.",
          scores: { claude: 0, gpt: 0, gemini: 3 } 
        }
      ]
    },
    {
      id: "use_case",
      scenario: "The Primary Use",
      question: "What do you mostly use AI for?",
      options: [
        { 
          id: "writing", 
          label: "Writing, editing, and creative work",
          scores: { claude: 3, gpt: 2, gemini: 0 } 
        },
        { 
          id: "research", 
          label: "Research, analysis, and learning",
          scores: { claude: 2, gpt: 3, gemini: 1 } 
        },
        { 
          id: "coding", 
          label: "Coding and technical tasks",
          scores: { claude: 2, gpt: 1, gemini: 3 } 
        },
        { 
          id: "everything", 
          label: "A bit of everything",
          scores: { claude: 2, gpt: 2, gemini: 2 } 
        }
      ]
    }
  ];

  // V2 Model profiles - Evidence-based from research
  const models = {
    claude: {
      id: 'claude',
      name: 'Claude',
      archetype: 'The Thoughtful Mentor',
      quotable: "You'd rather hear hard truths than comforting lies.",
      description: "You want an AI that thinks with you, not just for you. Claude is measured, honest about uncertainty, and willing to push back on weak ideas. Research shows it's the least sycophantic major model -- it won't tell you what you want to hear just to be agreeable.",
      traits: ['Challenges ideas', 'Admits uncertainty', 'Natural writing', 'Deep reasoning'],
      bestFor: "Writing, complex analysis, coding, and anyone who values honest feedback over validation.",
      watchOut: "Can be cautious. Sometimes refuses reasonable requests. Usage limits on free tier.",
      icon: 'ðŸ§ ',
      color: 'from-orange-500 to-amber-500'
    },
    gpt: {
      id: 'gpt',
      name: 'ChatGPT',
      archetype: 'The Eager Collaborator',
      quotable: "You want a partner who's always in your corner.",
      description: "You value enthusiasm and comprehensive support. ChatGPT is the most agreeable of the major models -- ready to help, encouraging, and thorough. It excels at making you feel supported while working through problems together.",
      traits: ['Encouraging', 'Comprehensive', 'Versatile', 'Well-structured'],
      bestFor: "Brainstorming, research, learning new topics, and anyone who works better with positive reinforcement.",
      watchOut: "Can be verbose. May tell you what you want to hear. \"Great question!\" fatigue is real.",
      icon: 'ðŸ’¬',
      color: 'from-emerald-500 to-green-500'
    },
    gemini: {
      id: 'gemini',
      name: 'Gemini',
      archetype: 'The Speed Demon',
      quotable: "You need results, not conversation.",
      description: "You value speed and efficiency over rapport. Gemini is fast, handles massive context windows, and gets straight to the output. Less personality, more execution. You probably verify outputs yourself anyway.",
      traits: ['Ultra-fast', 'Huge context', 'Direct', 'Technical'],
      bestFor: "Processing large documents, coding sprints, technical work, and anyone who values speed over conversation.",
      watchOut: "Less conversational warmth. Can feel corporate. Better at synthesis than dialogue.",
      icon: 'âš¡',
      color: 'from-blue-500 to-cyan-500'
    }
  };

  // State
  let currentQuestion = 0;
  let answers: Record<string, string> = {};

  // Elements
  const welcomeScreen = document.getElementById('welcome-screen')!;
  const questionScreen = document.getElementById('question-screen')!;
  const analyzingScreen = document.getElementById('analyzing-screen')!;
  const resultsScreen = document.getElementById('results-screen')!;
  const progressContainer = document.getElementById('progress-container')!;
  const progressBar = document.getElementById('progress-bar')!;
  const stepCounter = document.getElementById('step-counter')!;
  const scenarioLabel = document.getElementById('scenario-label')!;
  const questionText = document.getElementById('question-text')!;
  const questionSubtext = document.getElementById('question-subtext')!;
  const optionsContainer = document.getElementById('options-container')!;

  // Start quiz
  document.getElementById('start-btn')?.addEventListener('click', () => {
    welcomeScreen.classList.add('hidden');
    questionScreen.classList.remove('hidden');
    progressContainer.classList.remove('hidden');
    showQuestion(0);
  });

  // Show question
  function showQuestion(index: number) {
    const q = questions[index];
    scenarioLabel.textContent = q.scenario;
    questionText.textContent = q.question;
    
    if ((q as any).subtext) {
      questionSubtext.textContent = (q as any).subtext;
      questionSubtext.classList.remove('hidden');
    } else {
      questionSubtext.classList.add('hidden');
    }

    optionsContainer.innerHTML = '';
    q.options.forEach((opt, i) => {
      const btn = document.createElement('button');
      btn.className = 'w-full text-left px-5 py-4 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-xl hover:border-zinc-400 dark:hover:border-zinc-500 hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-all duration-200';
      btn.textContent = opt.label;
      btn.style.animationDelay = `${i * 50}ms`;
      btn.addEventListener('click', () => selectOption(q.id, opt.id));
      optionsContainer.appendChild(btn);
    });

    // Update progress
    const progress = ((index + 1) / questions.length) * 100;
    progressBar.style.width = `${progress}%`;
    stepCounter.textContent = `${index + 1}/${questions.length}`;
  }

  // Select option
  function selectOption(questionId: string, optionId: string) {
    answers[questionId] = optionId;
    
    if (currentQuestion < questions.length - 1) {
      currentQuestion++;
      showQuestion(currentQuestion);
    } else {
      showAnalyzing();
    }
  }

  // Show analyzing screen
  function showAnalyzing() {
    questionScreen.classList.add('hidden');
    progressContainer.classList.add('hidden');
    analyzingScreen.classList.remove('hidden');
    
    const messages = [
      "Matching your thinking style...",
      "Comparing with AI personalities...",
      "Calculating compatibility..."
    ];
    
    let msgIndex = 0;
    const analyzingText = document.getElementById('analyzing-text')!;
    
    const interval = setInterval(() => {
      msgIndex++;
      if (msgIndex < messages.length) {
        analyzingText.textContent = messages[msgIndex];
      }
    }, 600);
    
    setTimeout(() => {
      clearInterval(interval);
      analyzingScreen.classList.add('hidden');
      showResults();
    }, 1800);
  }

  // Calculate scores
  function calculateScores(): { claude: number; gpt: number; gemini: number } {
    const scores = { claude: 0, gpt: 0, gemini: 0 };
    
    for (const q of questions) {
      const answerId = answers[q.id];
      if (answerId) {
        const option = q.options.find(o => o.id === answerId);
        if (option) {
          scores.claude += option.scores.claude;
          scores.gpt += option.scores.gpt;
          scores.gemini += option.scores.gemini;
        }
      }
    }
    
    return scores;
  }

  // Get winner and runner up
  function getRankedModels(scores: { claude: number; gpt: number; gemini: number }) {
    const entries = Object.entries(scores) as [string, number][];
    entries.sort((a, b) => b[1] - a[1]);
    return entries;
  }

  // Get match percentage
  function getMatchPercentage(score: number, total: number): number {
    if (total === 0) return 0;
    const rawPercentage = (score / total) * 100;
    return Math.round(55 + (rawPercentage * 0.44)); // Scale to 55-99% range
  }

  // Show results
  function showResults() {
    const scores = calculateScores();
    const ranked = getRankedModels(scores);
    const total = scores.claude + scores.gpt + scores.gemini;
    
    const winnerId = ranked[0][0];
    const winnerScore = ranked[0][1];
    const runnerUpId = ranked[1][0];
    const runnerUpScore = ranked[1][1];
    
    const model = models[winnerId as keyof typeof models];
    const runnerUp = models[runnerUpId as keyof typeof models];
    
    const percentage = getMatchPercentage(winnerScore, total);
    const runnerUpPercentage = getMatchPercentage(runnerUpScore, total);

    resultsScreen.classList.remove('hidden');

    // Populate result card
    document.getElementById('result-icon')!.textContent = model.icon;
    document.getElementById('result-name')!.textContent = model.name;
    document.getElementById('result-archetype')!.textContent = model.archetype;
    document.getElementById('result-quotable')!.textContent = `"${model.quotable}"`;
    document.getElementById('match-percentage')!.textContent = `${percentage}%`;
    
    // Set gradient color for match bar
    const matchBar = document.getElementById('match-bar')!;
    matchBar.className = `h-full rounded-full transition-all duration-1000 ease-out bg-gradient-to-r ${model.color}`;
    
    // Animate match bar
    setTimeout(() => {
      matchBar.style.width = `${percentage}%`;
    }, 100);
    
    // Traits
    const traitsContainer = document.getElementById('traits-container')!;
    traitsContainer.innerHTML = '';
    model.traits.forEach(trait => {
      const tag = document.createElement('span');
      tag.className = 'px-3 py-1 bg-zinc-700/50 rounded-full text-sm text-zinc-300';
      tag.textContent = trait;
      traitsContainer.appendChild(tag);
    });

    // Populate detailed results
    document.getElementById('why-model-name')!.textContent = model.name;
    document.getElementById('result-description')!.textContent = model.description;
    document.getElementById('best-for-text')!.textContent = model.bestFor;
    document.getElementById('watch-out-text')!.textContent = model.watchOut;
    
    // Runner up
    document.getElementById('runner-up-icon')!.textContent = runnerUp.icon;
    document.getElementById('runner-up-name')!.textContent = `${runnerUp.name} (${runnerUp.archetype})`;
    document.getElementById('runner-up-percentage')!.textContent = `${runnerUpPercentage}% match`;
    document.getElementById('runner-up-description')!.textContent = runnerUp.bestFor;
  }

  // Share on X
  document.getElementById('share-btn')?.addEventListener('click', () => {
    const scores = calculateScores();
    const ranked = getRankedModels(scores);
    const total = scores.claude + scores.gpt + scores.gemini;
    const winnerId = ranked[0][0];
    const percentage = getMatchPercentage(ranked[0][1], total);
    const model = models[winnerId as keyof typeof models];
    
    const text = `I'm a ${model.name} person (${percentage}% match)\n\n"${model.quotable}"\n\nWhich AI thinks like you?`;
    const url = 'https://symbiotic.makestudio.app/benchmark';
    
    window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`, '_blank');
  });

  // Retake quiz
  document.getElementById('retake-btn')?.addEventListener('click', () => {
    currentQuestion = 0;
    answers = {};
    resultsScreen.classList.add('hidden');
    welcomeScreen.classList.remove('hidden');
  });
</script>
